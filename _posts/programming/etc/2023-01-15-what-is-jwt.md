---
title: "JWT(Json Web Token)"
categories: 
    - etc
date: 2023-01-15
last_modified_at: 2023-01-30
toc: true
toc_sticky: true
excerpt: "JWTλ€ λ¬΄μ—‡μΈκ°€?"
---

## JWT λ€
JWTλ” RFC7519 μ›Ή ν‘μ¤€μΌλ΅ μ§€μ •λμ–΄μκ³  JSON κ°μ²΄λ¥Ό μ‚¬μ©ν•΄μ„ ν† ν° μμ²΄μ— μ •λ³΄λ“¤μ„ μ €μ¥ν•κ³  μλ” μ›Ή ν† ν°μ΄λΌκ³  μ •μν•  μ μλ‹¤. νΉν JWTλ¥Ό μ΄μ©ν•λ” λ°©μ‹μ€ κ°„νΈν•κ³  μ‰½κ² μ μ©ν• μμλ‹¤.

<center><img src="https://user-images.githubusercontent.com/36228833/215335585-1cb33f15-c89c-4ba0-a82e-a2faed609851.png"></center><br/>

JWTλ” .μ„ κΈ°μ¤€μΌλ΅ `Header`, `Payload`, `Signature` 3κ°μ λ¶€λ¶„μΌλ΅ κµ¬μ„±λμ–΄μλ‹¤.

- `Header`
  - `Signature`λ¥Ό μ•”νΈν™”ν•κΈ° μ„ν• μ•κ³ λ¦¬μ¦ μ •λ³΄κ°€ λ‹΄κ²¨μλ‹¤.
  ```json
  {
       "alg" : "HS512", // Signature μ•”νΈν™” μ•κ³ λ¦¬μ¦ μΆ…λ¥ (HS256, HS384, SHA256,..)
       "typ" : "JWT" // ν† ν° μ ν•
  }
  ```
- `Payload`
  - μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ£Όκ³ λ°›μ„μ μλ”, μ‹μ¤ν…μ—μ„ μ‹¤μ λ΅ μ‚¬μ©λ  μ •λ³΄μ— λ€ν• λ‚΄μ©μ„ λ‹΄κ³ μλ‹¤.
  - key-valueλ΅ μ΄λ£¨μ–΄μ§„ ν•μμ μ •λ³΄λ¥Ό Claim μ΄λΌκ³  ν•λ‹¤.
  - `Payload`λ” μ©λ„μ— λ§κ² μ΄λ―Έ μ •ν•΄μ Έμλ” Registered Claimκ³Ό κ·Έ μ™Έ μ‚¬μ©μ μ§€μ • ν΄λ μ„μΌλ΅ κµ¬λ¶„λλ‹¤.
  ```json
  {
      // Registered Claim
      "iss": "ckr", // ν† ν° λ°κΈ‰μ (issuer)
      "sub": "jwt-test", // ν† ν° μ λ© (subject)
      "aud": "user", // ν† ν° λ€μƒμ (audience)
      "exp": "1485270000000", // ν† ν°μ λ§λ£μ‹κ°„ (expiraton), μ‹κ°„μ€ NumericDate ν•μ‹μΌλ΅ λμ–΄μμ–΄μ•Ό ν•λ©° (μ: 1480849147370) μ–Έμ λ‚ ν„μ¬ μ‹κ°„λ³΄λ‹¤ μ΄ν›„λ΅ μ„¤μ •λμ–΄μμ–΄μ•Όν•©λ‹λ‹¤.
      "nbf": "1185270003000", // Not Before λ¥Ό μλ―Έν•λ©°, ν† ν°μ ν™μ„± λ‚ μ§μ™€ λΉ„μ·ν• κ°λ…μ…λ‹λ‹¤. μ—¬κΈ°μ—λ„ NumericDate ν•μ‹μΌλ΅ λ‚ μ§λ¥Ό μ§€μ •ν•λ©°, μ΄ λ‚ μ§κ°€ μ§€λ‚κΈ° μ „κΉμ§€λ” ν† ν°μ΄ μ²λ¦¬λμ§€ μ•μµλ‹λ‹¤.
      "iat": "1482533320000", // ν† ν°μ΄ λ°κΈ‰λ μ‹κ°„ (issued at), μ΄ κ°’μ„ μ‚¬μ©ν•μ—¬ ν† ν°μ age κ°€ μ–Όλ§λ‚ λμ—λ”μ§€ νλ‹¨ ν•  μ μμµλ‹λ‹¤.
      "jti": "identifier1252#@%12a", // JWTμ κ³ μ  μ‹λ³„μλ΅μ„, μ£Όλ΅ μ¤‘λ³µμ μΈ μ²λ¦¬λ¥Ό λ°©μ§€ν•κΈ° μ„ν•μ—¬ μ‚¬μ©λ©λ‹λ‹¤. μΌνμ© ν† ν°μ— μ‚¬μ©ν•λ©΄ μ μ©ν•©λ‹λ‹¤.

      // μ‚¬μ©μκ°€ μ„μλ΅ λ“±λ΅ν• ν΄λ μ„
      "test123" : "test111" 
  }
  ```
- `Signature`
  - `Header`μ™€ `Signature`μ μΈμ½”λ”©λ κ°’ + secret-key κ°’μΌλ΅ μ΅°ν•©ν• κ°’μ„ `Header`μ—μ„ μ •μν• μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™”λ¥Ό ν•λ‹¤.
  - μ—¬κΈ°μ„ μ‚¬μ©λλ” secret-key κ°’μ€ λ³΄ν†µ μ„μμ κ°’μ„ νΉμ • μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™”ν• κ°’μ„ μ‚¬μ©ν•λ‹¤.
  - ν† ν°μ μ„/λ³€μ΅° μ—¬λ¶€λ¥Ό ν™•μΈ λ° μ ν¨μ„± κ²€μ¦μ„ ν•λ”λ° μ‚¬μ©ν•λ‹¤.
  
## JWT ν™μ©

μ£Όλ΅ JWTλ” ν΄λΌμ΄μ–ΈνΈμ— λ€ν• μΈμ¦ λ° κ¶ν• ν™•μΈμ„ μ„ν•΄ μ£Όλ΅ μ‚¬μ©λλ‹¤.

<center><img src="https://user-images.githubusercontent.com/36228833/215338648-b976c1b3-26aa-4703-8c16-feed7f2d3c43.png"></center>

### jwtκ°€ μ—†λ” κ²½μ°
1. ν΄λΌμ΄μ–ΈνΈλ” jwt λ°κΈ‰μ„ μ„ν•΄ ν•„μ”ν• μ •λ³΄(ex. μ•„μ΄λ””/ν¨μ¤μ›λ“)λ“¤μ„ μ„λ²„μ— λμ§€λ©° μ”μ²­μ„ ν•λ‹¤.
2. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ λμ§„ μ •λ³΄λ“¤μ μ ν¨μ„±μ„ κ²€μ¦ν•λ‹¤.
  - μ ν¨ν• κ°’μΈκ²½μ° jwtλ¥Ό headerμ— λ‹΄μ•„μ„ λ³΄λ‚Έλ‹¤.
  - μ ν¨ν•μ§€ μ•μ„κ²½μ° μμ™Έμ²λ¦¬λ¥Ό ν•λ‹¤.

### jwtκ°€ μλ” κ²½μ°
1. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—μ„ λ°κΈ‰λ°›μ€ jwtλ¥Ό headerμ— λ‹΄μ•„μ„ μ„λ²„μ— apiλ¥Ό μ”μ²­ν•λ‹¤.
2. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ λμ§„ jwtλ¥Ό κ²€μ¦ν•λ‹¤.
  - μ ν¨ν• κ²½μ° ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­ν• apiλ¥Ό μν–‰ν•λ‹¤.
  - μ ν¨ν•μ§€ μ•μ„κ²½μ° ν† ν° κ°’μ— λ”°λΌ 401 νΉμ€ 403 responseλ¥Ό λ³΄λ‚Έλ‹¤.

## μ¥μ  λ° λ‹¨μ 
JWTλ” λ‹¤μκ³Ό κ°™μ€ μ¥μ , λ‹¨μ λ“¤μ„ κ°€μ§„λ‹¤.

μ¥μ 
- μ¤‘μ•™μ μΈμ¦μ„λ²„μ™€ λ°μ΄ν„° μ¤ν† μ–΄μ— λ€ν• μμ΅΄μ„±μ΄ μ—†κΈ° λ•λ¬Έμ— μ‹μ¤ν… μν‰ν™•μ¥μ— μ λ¦¬ν•λ‹¤.
- Base64 URL Safe Encodingμ„ μ΄μ©ν•κ³  μκΈ°λ•λ¬Έμ— URL, Cookie, Headerμ— λ¨λ‘ μ‚¬μ© κ°€λ¥ν•λ‹¤.

λ‹¨μ 
- Payloadμ μ •λ³΄κ°€ λ§μ•„μ§€λ©΄ λ„¤νΈμ›ν¬ μ‚¬μ©λ‰μ΄ μ¦κ°€ν•λ―€λ΅ μ΄λ¥Ό κ³ λ ¤ν•μ—¬ μ„¤κ³„ν•΄μ•Ό ν•λ‹¤.
- ν† ν°μ΄ ν΄λΌμ΄μ–ΈνΈμ— μ €μ¥λλ―€λ΅ μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈμ ν† ν°μ„ μ΅°μ‘ν•  μ μ—†λ‹¤.

## π“£ Reference
[JSON μ›Ή ν† ν°](https://ko.wikipedia.org/wiki/JSON_%EC%9B%B9_%ED%86%A0%ED%81%B0)
[jwt.io](https://jwt.io/)